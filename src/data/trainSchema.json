{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Train Configuration Schema",
  "type": "array",
  "items": {
    "type": "object",
    "properties": {
      "descName": {
        "type": "string",
        "description": "Localized display name for the train"
      },
      "trainName": {
        "type": "string",
        "description": "Internal identifier for the train"
      },
      "groupType": {
        "type": "string",
        "enum": ["semiPrivate", "private", "public"],
        "description": "Ownership type of company of the train"
      },
      "introductionDate": {
        "type": "string",
        "pattern": "^\\d{4}, \\d{1,2}, \\d{1,2}$",
        "description": "Date when train was introduced (YYYY, M, D)"
      },
      "scrapYear": {
        "type": "integer",
        "minimum": 0,
        "description": "Year when train was scrapped, 0 for never"
      },
      "costFactor": {
        "type": "integer",
        "minimum": 0,
        "description": "Base cost multiplier"
      },
      "runningCost": {
        "type": "integer",
        "minimum": 0,
        "description": "Operating cost per unit multiplier"
      },
      "variantGroup": {
        "type": "integer",
        "description": "Group identifier for train variants"
      },
      "isVariantGroupParent": {
        "type": "string",
        "description": "Indicates if this is the parent variant in a group"
      },
      "speed": {
        "type": "integer",
        "minimum": 0,
        "description": "Maximum speed in km/h"
      },
      "trackGauge": {
        "type": "integer",
        "minimum": 0,
        "description": "Track gauge in mm",
        "enum": [1067, 1372, 1435]
      },
      "weight": {
        "type": "array",
        "items": {
          "type": "integer",
          "minimum": 1
        },
        "minItems": 2,
        "description": "Weight per vehicle section in tons. [0] is for head cars, [1] is for trailer/motor cars"
      },
      "formations": {
        "type": "array",
        "items": {
          "type": "integer",
          "minimum": 1
        },
        "minItems": 1,
        "description": "Available train formation lengths"
      },
      "doors": {
        "type": "array",
        "items": {
          "type": "integer",
          "minimum": 1
        },
        "minItems": 1,
        "maxItems": 2,
        "description": "Number of doors per vehicle side, second value for 'refit to n is available'"
      },
      "current": {
        "type": "array",
        "items": {
          "type": "string",
          "enum": ["DC_1500", "AC_20000_50hz", "AC_20000_60hz", "AC_250000", "AC_20_50hz_DC", "AC_20_60hz_DC", "AC_25_50hz_DC"]
        },
        "minItems": 1,
        "description": "Electrical system and voltage compatibility"
      },
      "usage": {
        "type": "array",
        "items": {
          "type": "string",
          "enum": ["metro", "commuter", "express", "limitedExpress", "accessCommuter", "accessExpress", "accessLimitedExpress"]
        },
        "minItems": 1,
        "description": "Primary usage types"
      },
      "operator": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "minItems": 1,
        "description": "Operating companies or authorities"
      },
      "capacity": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "introYear": {
              "type": "integer",
              "description": "Year when this capacity configuration was introduced, empty for default"
            },
            "headCapacity": {
              "type": "array",
              "items": {
                "type": "integer",
                "minimum": 0
              },
              "minItems": 1,
              "description": "Passenger capacity for head vehicles"
            },
            "wagCapacity": {
              "type": "array",
              "items": {
                "type": "integer",
                "minimum": 0
              },
              "minItems": 1,
              "description": "Passenger capacity for standard wagons from head"
            },
            "wagCapacityReverse": {
              "type": "array",
              "items": {
                "type": "integer",
                "minimum": 0
              },
              "description": "Passenger capacity for standard wagons from end"
            },
            "liveryUsageIds": {
              "type": "array",
              "items": {
                "type": "integer",
                "minimum": 0
              },
              "description": "Liveries that use this capacity configuration"
            }
          },
          "required": ["headCapacity", "wagCapacity"]
        }
      },
      "power": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "introYear": {
              "type": "integer",
              "description": "Year when this power configuration was introduced, empty for default"
            },
            "powerPerMotor": {
              "type": "integer",
              "minimum": 0,
              "description": "Power output per motor in kW"
            },
            "headMotorCars": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of motorized head cars, empty for 0"
            },
            "blockLength": {
              "type": "integer",
              "minimum": 1,
              "description": "Block length for power distribution calculations"
            },
            "positions": {
              "type": "array",
              "items": {
                "type": "integer",
                "minimum": 0
              },
              "minItems": 1,
              "description": "Vehicle positions that have motors"
            },
            "liveryUsageIds": {
              "type": "array",
              "items": {
                "type": "integer",
                "minimum": 0
              },
              "description": "Liveries that use this power configuration"
            }
          },
          "required": ["powerPerMotor", "blockLength", "positions"]
        }
      },
      "liveries": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "descString": {
              "type": "string",
              "description": "Localized description of the livery"
            },
            "introYear": {
              "type": "string",
              "description": "Year when livery was introduced, empty for default"
            },
            "useSpriteSet": {
              "type": "integer",
              "minimum": 0,
              "description": "Reference to sprite set index, empty for default"
            },
            "setPurchase": {
              "type": "boolean",
              "description": "Whether this used for the purchase menu livery"
            },
            "panto": {
              "type": "object",
              "properties": {
                "variations": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "introYear": {
                        "type": "integer",
                        "description": "Year when this pantograph variation was introduced, empty for default"
                      },
                      "placement": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "length": {
                              "type": "integer",
                              "minimum": 1,
                              "description": "Train length this placement applies to"
                            },
                            "positions": {
                              "type": "object",
                              "patternProperties": {
                                "^[0-9]+(_REV)?$": {
                                  "type": "string"
                                }
                              },
                              "description": "Pantograph positions by vehicle index and symmetry"
                            }
                          },
                          "required": ["positions"]
                        }
                      },
                      "main": {
                        "type": "object",
                        "patternProperties": {
                          "^[0-9]+$": {
                            "type": "string",
                            "pattern": "^[0-9]+(\\|[0-9]+)*$"
                          }
                        },
                        "description": "Main pantograph configuration with possible random switches"
                      }
                    },
                    "required": ["placement", "main"]
                  }
                }
              },
              "required": ["variations"]
            },
            "customFrontGfx": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "introYear": {
                    "type": "integer",
                    "description": "Year when this front graphics variation was introduced"
                  },
                  "modernizationYear": {
                    "type": "integer",
                    "description": "Year when this variation was modernized"
                  },
                  "useSpriteSet": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "Sprite set to use for this variation, empty for default"
                  },
                  "spriteArray": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "minItems": 1,
                    "description": "Sprite identifiers for front graphics"
                  }
                },
                "required": ["spriteArray"]
              }
            },
            "customEndGfx": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "introYear": {
                    "type": "integer",
                    "description": "Year when this end graphics variation was introduced"
                  },
                  "modernizationYear": {
                    "type": "integer",
                    "description": "Year when this variation was modernized"
                  },
                  "useSpriteSet": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "Sprite set to use for this variation"
                  },
                  "spriteArray": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "minItems": 1,
                    "description": "Sprite identifiers for end graphics"
                  }
                },
                "required": ["spriteArray"]
              }
            },
            "customMotData": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "introYear": {
                    "type": "integer",
                    "description": "Year when this motor graphics variation was introduced"
                  },
                  "modernizationYear": {
                    "type": "integer",
                    "description": "Year when this variation was modernized"
                  },
                  "useSpriteSet": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "Sprite set to use for this variation"
                  },
                  "isMirrored": {
                    "type": "boolean",
                    "description": "Whether this sprite should be mirrored"
                  },
                  "mirrorBlock": {
                    "type": "integer",
                    "description": "Block size for mirroring"
                  },
                  "spriteArray": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "minItems": 1,
                    "description": "Sprite identifiers for motor vehicles"
                  }
                },
                "required": ["spriteArray"]
              }
            },
            "customWagData": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "introYear": {
                    "type": "integer",
                    "description": "Year when this wagon graphics variation was introduced"
                  },
                  "modernizationYear": {
                    "type": "integer",
                    "description": "Year when this variation was modernized"
                  },
                  "useSpriteSet": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "Sprite set to use for this variation"
                  },
                  "isMirrored": {
                    "type": "boolean",
                    "description": "Whether this sprite should be mirrored"
                  },
                  "mirrorBlock": {
                    "type": "integer",
                    "description": "Block size for mirroring"
                  },
                  "insertAtPosition": {
                    "type": "array",
                    "items": {
                      "type": "integer",
                      "minimum": 0
                    },
                    "description": "Positions where this wagon type should be inserted"
                  },
                  "loadSpeedChange": {
                    "type": "integer",
                    "description": "Loading speed modification for this wagon type"
                  },
                  "spriteArray": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "minItems": 1,
                    "description": "Sprite identifiers for wagon vehicles"
                  }
                },
                "required": ["spriteArray"]
              }
            }
          }
        }
      },
      "hasPanto": {
        "type": "boolean",
        "description": "Whether the train has pantographs"
      },
      "isDualHeaded": {
        "type": "boolean",
        "description": "Whether the train is dual-headed"
      },
      "customLoadingSpeedLogic": {
        "type": "string",
        "description": "Custom loading speed logic in .pnml"
      },
      "customSpeedLogic": {
        "type": "string",
        "description": "Custom speed logic in .pnml"
      },
      "spriteSets": {
        "type": "array",
        "description": "Array of sprite set groups",
        "items": {
          "type": "array",
          "description": "A group of sprite definitions",
          "items": {
            "type": "array",
            "description": "Individual sprite definition",
            "minItems": 2,
            "maxItems": 3,
            "items": [
              {
                "type": "string",
                "description": "Sprite name/identifier"
              },
              {
                "type": "string",
                "description": "Template reference with coordinates"
              },
              {
                "type": "object",
                "description": "Sprite component mappings",
                "properties": {
                  "ac": {
                    "type": "string",
                    "description": "AC component sprite reference",
                    "optional": true
                  },
                  "panto": {
                    "type": "string",
                    "description": "Pantograph component sprite reference",
                    "optional": true
                  },
                  "lights": {
                    "type": "string",
                    "description": "Lights component sprite reference",
                    "optional": true
                  }
                }
              }
            ]
          }
        }
      }
    },
    "required": [
      "descName",
      "trainName",
      "groupType",
      "introductionDate",
      "scrapYear",
      "costFactor",
      "runningCost",
      "speed",
      "trackGauge",
      "weight",
      "formations",
      "doors",
      "current",
      "usage",
      "operator",
      "liveries",
      "spriteSets"
    ]
  }
}
